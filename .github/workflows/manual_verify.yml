name: Manual Rust Verification ğŸ› ï¸

# To sprawia, Å¼e workflow uruchamia siÄ™ TYLKO rÄ™cznie przyciskiem
on:
  workflow_dispatch:

env:
  CARGO_TERM_COLOR: always

jobs:
  verify-windows:
    name: Check & Build (Windows)
    runs-on: windows-latest  # WaÅ¼ne: uÅ¼ywamy Windowsa, bo masz kod specyficzny dla tego OS

    steps:
      - name: ğŸ“¥ Pobranie kodu (Checkout)
        uses: actions/checkout@v4

      - name: ğŸ¦€ Instalacja Rust
        uses: dtolnay/rust-toolchain@stable
        with:
          components: clippy

      - name: âš¡ Cache (Przyspieszenie budowania)
        # To kluczowe przy SurrealDB - pierwsze uruchomienie potrwa dÅ‚ugo,
        # kolejne bÄ™dÄ… braÅ‚y skompilowane biblioteki z cache'a.
        uses: Swatinem/rust-cache@v2

      # 1. Szybkie sprawdzenie (Debug)
      - name: ğŸ” Cargo Check
        run: cargo check

      # 2. Szybkie sprawdzenie (Release)
      - name: ğŸ” Cargo Check (Release)
        run: cargo check --release

      # 3. Clippy - TwÃ³j straÅ¼nik jakoÅ›ci (Debug)
      # -D warnings sprawia, Å¼e warningi sÄ… traktowane jak bÅ‚Ä™dy (failuje build)
      - name: ğŸ“ Cargo Clippy
        run: cargo clippy -- -D warnings

      # 4. Clippy (Release)
      - name: ğŸ“ Cargo Clippy (Release)
        run: cargo clippy --release -- -D warnings

      # 5. Budowanie (To potrwa najdÅ‚uÅ¼ej)
      - name: ğŸ—ï¸ Cargo Build (Release)
        run: cargo build --release --verbose

      # OPCJONALNIE: JeÅ›li chcesz mÃ³c pobraÄ‡ zbudowane pliki exe z GitHuba
      - name: ğŸ“¤ Upload Artifacts (Exe Files)
        uses: actions/upload-artifact@v4
        with:
          name: windows-binaries
          path: |
            target/release/manager.exe
            target/release/editor.exe
            target/release/*.dll
            target/release/*.pdb
          if-no-files-found: warn
