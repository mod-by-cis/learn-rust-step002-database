name: Verify CLI Branch (Manual) ğŸ› ï¸

on:
  workflow_dispatch:

env:
  CARGO_TERM_COLOR: always

jobs:
  verify-windows:
    name: Build & Check (Windows)
    # W Twoim przykÅ‚adzie "Deploy Release" uÅ¼ywaÅ‚eÅ› windows-latest - trzymamy siÄ™ tego.
    runs-on: windows-latest

    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4

      # Instalacja Rusta (Stable)
      - name: ğŸ¦€ Install Rust Toolchain
        uses: dtolnay/rust-toolchain@stable
        with:
          components: clippy, rustfmt

      # Cache - kluczowe przy SurrealDB. 
      # DziaÅ‚a podobnie jak sekcja "Cache Cargo" w Twoim starym pliku, ale automat.
       - name: âš¡ Rust Cache
       uses: Swatinem/rust-cache@v2

      # Z Twojego pliku "Rust CI & Build" - sprawdzamy czy kod jest Å‚adnie sformatowany
      # - name: ğŸ¨ Check Formatting
      #  run: cargo fmt -- --check

      # Szybkie sprawdzenie (Debug)
      - name: ğŸ” Cargo Check
        run: cargo check

      # Linter (Clippy) - wyÅ‚apie bÅ‚Ä™dy zanim poÅ›wiÄ™cisz czas na dÅ‚ugie budowanie
      - name: ğŸ“ Cargo Clippy
        run: cargo clippy -- -D warnings

      # Budowanie wersji Release (najdÅ‚uÅ¼szy etap)
      - name: ğŸ—ï¸ Cargo Build (Release)
        run: cargo build --release --verbose

      # Pakowanie artefaktÃ³w (na wzÃ³r Twojego "Upload Windows Artifact")
      # Ale zmienione tak, by Å‚apaÅ‚o OBA pliki exe
      - name: ğŸ“¤ Upload Binaries
        uses: actions/upload-artifact@v4
        with:
          name: arboretum-windows-build
          path: |
            target/release/manager.exe
            target/release/editor.exe
          if-no-files-found: warn
